<h1 align="center">HeartRate Monitor Widget ❤️</h1>

<div align="center">
  <img src="https://badgen.net/static/license/MIT/blue"/>
  <img src="https://badgen.net/badge/Language/Python/orange"/>
  <br><br>
  <img src="icon.png" alt="Icon" width=160>
  <br><br>
</div>

> Web-виджет для отображения текущего значения пульса.<br>

## Возможности

- **Мониторинг сердечного ритма**: Отображение текущего сердечного ритма в реальном времени.
- **HTTP API**: Приложение получает данные через HTTP-POST запросы.
- **Кастомизация интерфейса**: Выбор скинов и иконок web-виджета.
- **Локальный сервер**: Доступ к web-виджету через локальный IP-адрес.

## Использование
### Графический интерфейс
- После запуска приложения откроется окно с настройками.
- Вы можете выбрать скин и иконку для отображения сердечного ритма.
- В окне отображается адрес для доступа к web-виджету и адрес API. При нажатии на кнопку **API Info** будет показан пример ожидаемого json с пульсом.
### Web-виджет
- Откройте указанный URL (например, http://127.0.0.1:5050) в браузере.
- Наблюдайте за отображением текущего сердечного ритма.
### API
- Отправьте POST-запрос на /send с JSON-данными:
>{"heartRate": 75}

### Пример использования
>Изначально проект создавался для использования совместно с **Notify For Mi Band**, который отправляет интенты в **Tasker**, а уже тот в свою очередь отправляет их в данное приложение. По итогу виджет был выведен в **OBS** и на записи/трансляции можно наблюдать за пульсом.

#### Настройка **Notify For Mi Band**
1. Включите режим *Notify app mode* в настройках мониторинга сердечного ритма.
2. Включите режим неприрывного измерения сердечного ритма.

После измерения сердечного ритма приложение отправит интент с действием *com.mc.miband.heartRateGot* и дополнительным параметром *value*, содержащим измеренное значение.

#### Настройка **Tasker**
1. Создайте новый профиль в **Tasker**:
- Тип: *Event* → *Intent Received*.
- Action: *com.mc.miband.heartRateGot*.
2. Добавьте задачу для обработки интента:
- Task → HTTP Request:
- Method: POST.
- URL: http://<IP отображаемый в приложении:5050/send.
- Content-Type: application/json.
- Body:
  >{"heartRate": %value}
3. Сохраните настройки.

Теперь, когда **Mi Band** измеряет сердечный ритм, **Tasker** автоматически отправит данные в виджет.


### Примечания
Файл конфигурации **config.ini** создается автоматически при первом запуске. В нём содержатся следующие параметры:

- **http_port**: Порт для HTTP-сервера (по умолчанию 5050) web-виджета. **Нельзя изменить в окне приложения!*
- **skin**: Текущий скин для web-виджета.
- **icon**: Текущая иконка для web-виджета.

После применения любого скина/иконки в приложении - все подключенные клиенты (обычный браузер или встроенный в **OBS**) получат команду на обновление страницы для отображения выбранного скина/иконки.

## Структура приложения

├── HeartRate_Monitor_Widget.exe&emsp;&emsp;&emsp;&emsp;&emsp;# Основной файл приложения<br>
├── config.ini&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&ensp;# Файл конфигурации *(создается автоматически)*<br>
├── skins/&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;# Папка со скинами web-виджета (CSS-файлы)<br>
├── icons/&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;# Папка с иконками web-виджета (SVG-файлы)<br>
├── icons/misc.js&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&nbsp;# Собственный js-код для инъекции в **index.html**

>Стандартные файлы **default.css**, **heart-default.svg** и **icons/misc.js** сгенерируются автоматически при запуске.


## Лицензия
Этот проект распространяется под лицензией MIT.

## Автор
Разработано с ❤️ by [frsvme](https://github.com/frsvme).
